const vision = require('@google-cloud/vision');

const CREDENTIALS = JSON.parse(JSON.stringify({
    "type": "service_account",
    "project_id": "ethereal-shine-379615",
    "private_key_id": "32058cc408c4a6185d0f4acda2fbd8e37bd50027",
    "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCwu2j66sJqX3I6\nJnCBY+vxLBLVxUJU7cNOhvZHte/pfHGk9UMXN/Z9mY8+kUuPK6beRpw39fQi9VI0\nZ8d7rhlhzzvGt/8u3MqVKpVDo0O+b4UNbScTaw/iWaX2XIQRYxxyOcSHNmy5BkPx\nTYe0dP3UYXurbSgM6MFjm1aqd48ZSXjWV9NbBRT4RXpaDza07FblfbZHrfjrmmUr\nI3JUEp+fma/XXh/PzQuVWiyqyxXUqOCBxQcktjfIBxezAGitdErb3bKcZYr0325i\nExuPmot6qVeIrMw9oXl12cW2V8M4W/gtlv1gKzHbBXacXtIhpSY2X3ihg3MPF+5I\nrCemyi0/AgMBAAECggEAEVm0yr11bMAGFNNlRC6tITY0eywsgO3+uJzjXNLtxLxk\n4874UTU7S8VhnMDi7CFa9oN0HsJUv4HaGi7+FJRZBZM0ySOTN+SRNufBU6yZn/6O\nz2yh43QlURGAC5m1lYdnaYdmVefv8JI+5Ve5NOwvZ0RSwderkOjg44iCj6XBNLgp\n3A8UdhnhS2fRx+GWPvQNCRMctzP20tZiIwPKRE1ZUzGO/FFiPu5Mg3GY5iTj4mJi\nojtVOVUBCysqyNKp4geSRGLuKuodUPhjGxlRp76TqevJR+aRCZ7Zj//5k59RExB7\nn6vjj1/dRP4hVrY6D8KO6kXE9jMKHAC05P5lmwwDIQKBgQDrZ2LVnGoPw7f3hfbc\n40/0yZc+oaO7iTvBGGOGyZ4KvK+nBrqyET/pMTYJzRkf8K0FsuZE8SpFL1niGX3n\n4ISQdDBqTnC1jZVmHaRbcsJ4fbKywCRKodeLngUyzQPQlob2U7kL/Vq7BrSocW1h\n21LkhDsYH2zIXZC4coLYKDIG2QKBgQDAMeJFFA7USzAepxRd73DGfZ2A3fSsXNSx\n3TJ116keDlQGMaDcGv+Wqe0OG0vcnSY6mDOwbd4i0DaPwtUTg23ERjTwiXgMHAVa\npnRzMuCxKvshu2i3trC8T+5LTtU7qz1inF+GdqbmNBIqNIJ6JI5Pgl5W9cs3Gxg+\ncV19Rge11wKBgQDEAQliIyKMjcIX7wtlUD+66j9sftn9xH5kgRIdoLJe7kyzHf9F\nVOeKGteLwaIx3guyuwrQTJ2Njaehgug6sc6vGI9XdIiUIpdKt1OqcRtLiB3KiAGv\nwqHeNmzNp7aNb0hgwcVKHmH1Z9f0iL0yxZN3gkJSC5hgHMfrTC12HcHJwQKBgBrG\nWElbU/2LQ/bhO9siQknEsi6DvVRN0mu87wyvsKW5RUdfnpNLR5QLtDSk5NqlIfBD\nx9+qTqn268L3V4vSYXZYeYORAyJcvPo1+j8aNWc5H6dBXoNJdjGlyQLAxr/7SR/1\nvPEUkoe7dVRf4FV3xkOZW98tetQAeE4qqOWM3gIdAoGAIWy9DbYdr23QlhGnyEC+\n/n/OrCD+B+C/bpIxoSMyBbIldRtz9EFjAkEJVckQvLk+24FkXW4txVtSPHujHFxm\n7Ffh0g/bokw5cpiOJ8e/OaZc6khKIHoSUJeXDiMcUyHlC3E0DjroIIMEHJbAudiL\nut6hMzvQIp7zE3hycyj7CG4=\n-----END PRIVATE KEY-----\n",
    "client_email": "thurka-service-account@ethereal-shine-379615.iam.gserviceaccount.com",
    "client_id": "102419400711885346447",
    "auth_uri": "https://accounts.google.com/o/oauth2/auth",
    "token_uri": "https://oauth2.googleapis.com/token",
    "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
    "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/thurka-service-account%40ethereal-shine-379615.iam.gserviceaccount.com"
  }));

const CONFIG = {
  credentials: {
      private_key: CREDENTIALS.private_key,
      client_email: CREDENTIALS.client_email
  }
};

const client = new vision.ImageAnnotatorClient(CONFIG);

export const colors = async(req, res) => {
  console.log(req.body.data)
  let[result] = await client.imageProperties(req.body.data);
  let dom_colors = result.imagePropertiesAnnotation.dominantColors.colors
  console.log(dom_colors);
  //return dom_colors;
  res.status(200).json({ result:dom_colors});
}


  